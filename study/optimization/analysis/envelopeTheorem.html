<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./../../../css/css_wipe/reset.css">
    <link rel="stylesheet" href="./../../../css/style.css">
    <link rel="stylesheet" href="./../../../icon/bootstrap/icons-1.8.3/font/bootstrap-icons.css">
    <link rel="stylesheet" href="./../../../icon/fontawsome-free-6.1.1-web/css/all.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/styles/default.min.css">
    <script
        type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ["\\(","\\)"]] } });
        MathJax.Hub.Config({
            CommonHTML: {
                scale: 85
            },
            "HTML-CSS": {
                scale: 85
            },
            NativeMML: {
                scale: 85
            },
            SVG: {
                scale: 85
            },
            PreviewHTML: {
                scale: 85
            }
            });
    </script>
    <script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML">
        </script>
    <title>包絡線定理とは</title>
</head>


<body>

    <header></header>

    <main>

        <article>

            <div class="ly_lv1Heading">
                <h1 class="el_lv1Heading">
                    <span>包絡線定理</span>
                </h1>
                <p>
                    <a class="el_btn el_btn__small" href="./../../../index.html">トップページ</a>
                    <a class="el_btn el_btn__small" href="./../../../study.html">勉強部屋</a>
                </p>
                <p>
                    <span class="el_tag">最適化理論</span>
                </p>
            </div>

            <section class="ly_cont">
                <h2 class="el_lv2Heading">
                    目次
                </h2>
                <div>
                    <ol>
                        <li><a href="#01">包絡線とは</a></li>
                        <li><a href="#02">包絡線定理</a></li>
                        <li><a href="#03">具体例</a></li>
                    </ol>
                </div>
            </section>


            <section class="ly_cont">
                <h2 class="el_lv2Heading" id="01">
                    <span>01</span>包絡線とは
                </h2>
                <div>
                    <div>
                        <h3 class="el_lv3Heading">定義</h3>
                        <p>
                            <span class=el_math>$\alpha$</span> をパラメータとする曲線群 <span class=el_math>$f(\boldsymbol{x}|\alpha)=0$</span> の全てと接線を共有する関数．
                        </p>
                    </div>
                    <div>
                        <h3 class="el_lv3Heading">具体例</h3>
                        <p>
                            $y = 2\alpha x - \alpha^2$ の包絡線は $y = x^2$ である．
                        </p>

                        <img src="./../../../img/study/optimization/envelopeTheorem/envelop.gif">
                    </div>
                </div>
            </section>

            <section class="ly_cont">
                <h2 class="el_lv2Heading" id="02">
                    <span>02</span>包絡線定理
                </h2>
                <div>
                    <div>
                        <h3 class="el_lv3Heading">包絡線定理とは</h3>
                        <div class="el_theorem">
                            <p>
                                <span class="el_math">$\alpha$</span> をパラメータとする最適化問題
                                \[ \min_{\boldsymbol{x}}f(\boldsymbol{x}|\alpha) \]
                                \begin{align}
                                    \text{s.t.} \quad 
                                    g_j(\boldsymbol{x}|\alpha) &= 0 && \forall i\\
                                    h_k(\boldsymbol{x}|\alpha) &\geq 0 && \forall j
                                \end{align}
                                について，
                                <span class="el_math">$f(\boldsymbol{x}|\alpha), g_j(\boldsymbol{x}|\alpha), h_k(\boldsymbol{x}|\alpha)$</span> が全ての <span class="el_math">$x_i, \alpha$</span> について微分可能であるとする．
                            </p>
                            <p>
                                この最適化問題の最適値を $Z(\alpha)$ とすると，以下の式が成り立つ：
                                \[
                                    \frac{\partial Z(\alpha)}{\partial \alpha} = \frac{\partial f(\boldsymbol{x}|\alpha)}{\partial \alpha} - 
                                    \sum_j \lambda_j \frac{\partial g_j(\boldsymbol{x}|\alpha)}{\partial \alpha} - 
                                    \sum_k \mu_k \frac{\partial h_j(\boldsymbol{x}|\alpha)}{\partial \alpha}
                                \]
                                ここで， $\lambda_j, \mu_k$ はそれぞれ制約条件 $g_j(\boldsymbol{x}|\alpha)=0, h_k(\boldsymbol{x}|\alpha) \geq 0$ 
                                に対応するラグランジュ乗数である．
                            </p>
                        </div>
                    </div>
                    <div>
                        <h3 class="el_lv3Heading">証明</h3>
                        <div class="el_proof">
                            <p>
                                まず，上記の最適化問題の(1次の)最適性条件を考える．
                                最適性条件は以下の通り：
                                \begin{align}
                                    \frac{\partial f(\boldsymbol{x}|\alpha)}{\partial x_i} &= 
                                    \sum_j \lambda_j \frac{\partial g_j(\boldsymbol{x}|\alpha)}{\partial x_i} +
                                    \sum_k \mu_k \frac{\partial h_j(\boldsymbol{x}|\alpha)}{\partial x_i}
                                    && \forall i
                                    \\
                                    g_j(\boldsymbol{x}|\alpha) &= 0
                                    && \forall j
                                    \\
                                    \mu_k h_k(\boldsymbol{x}|\alpha) &= 0,
                                    \quad
                                    \mu_k \geq 0, \quad h_k(\boldsymbol{x}|\alpha)\geq 0
                                    && \forall k
                                \end{align}
                            </p>
                            <p>
                                上記の最適化問題の最適解を $\boldsymbol{x}^*(\alpha)$ とおくと以下の式が成り立つ：
                                \[
                                    Z(\alpha) = f(\boldsymbol{x}^*(\alpha) | \alpha)
                                \]
                                \[
                                    \boldsymbol{x}^*(\alpha) \equiv 
                                    \arg\min_{\boldsymbol{x}} \left[ \quad f(\boldsymbol{x}|\alpha) \quad | \quad \text{s.t.} 
                                    \quad g_j(\boldsymbol{x}|\alpha) = 0, h_k(\boldsymbol{x}|\alpha) \geq 0 \quad \right] 
                                \]
                            </p>
                            <p style="color: #ff0000;">※重要なのはここから※</p>
                            <p>
                                ここで，今後のために最適値関数に特別な項(最適性条件から0となる項)を追加する(ラグランジュ関数)．
                                \[
                                    Z_2(\alpha) = f(\boldsymbol{x}^*(\alpha) | \alpha) - 
                                    \sum_j \lambda_jg_j(\boldsymbol{x}^*(\alpha)|\alpha) -
                                    \sum_k \mu_kh_j(\boldsymbol{x}^*(\alpha)|\alpha)
                                \]
                            </p>
                            <p>
                                この 
                                <span style="color:#e25c00"> $\boldsymbol{x}^*(\alpha)$ が微分可能な関数である場合</span>，以下の式が成立する：
                                \begin{align}
                                    \frac{\partial Z(\alpha)}{\partial \alpha}
                                    =
                                    &
                                    \quad
                                    \left[
                                    \left(
                                    \sum_i \frac{\partial f(\boldsymbol{x}|\alpha)}{\partial x_i}
                                    \frac{\partial x_i^*(\alpha)}{\partial \alpha}
                                    +
                                    \frac{\partial f(\boldsymbol{x}|\alpha)}{\partial \alpha}
                                    \right)\right.
                                    \\
                                    &
                                    \qquad
                                    \left.
                                    -
                                    \sum_j \lambda_j 
                                    \left(
                                        \frac{\partial g_j(\boldsymbol{x}|\alpha)}{\partial x_i} 
                                        \frac{\partial x_i^*(\alpha)}{\partial \alpha}
                                        +
                                        \frac{\partial g_j(\boldsymbol{x}|\alpha)}{\partial \alpha}
                                    \right) 
                                    -
                                    \sum_k \mu_k
                                    \left(
                                    \frac{\partial h_j(\boldsymbol{x}|\alpha)}{\partial x_i}
                                    \frac{\partial x_i^*(\alpha)}{\partial \alpha}
                                    +
                                    \frac{\partial g_j(\boldsymbol{x}|\alpha)}{\partial \alpha}
                                    \right)
                                    \right]_{\boldsymbol{x}= \boldsymbol{x}^*(\alpha)}
                                    \\
                                    =&
                                    \quad
                                    \frac{\partial x_i^*(\alpha)}{\partial \alpha}
                                    \left[ 
                                        \frac{\partial f(\boldsymbol{x}|\alpha)}{\partial x_i} 
                                        -
                                        \sum_j \lambda_j \frac{\partial g_j(\boldsymbol{x}|\alpha)}{\partial x_i} 
                                        -
                                        \sum_k \mu_k \frac{\partial h_j(\boldsymbol{x}|\alpha)}{\partial x_i}
                                    \right]_{\boldsymbol{x}=\boldsymbol{x}^*(\alpha)}
                                    \\
                                    &\qquad 
                                    +
                                    \frac{\partial f(\boldsymbol{x}|\alpha)}{\partial \alpha} -
                                    \sum_j \lambda_j \frac{\partial g_j(\boldsymbol{x}|\alpha)}{\partial \alpha} -
                                    \sum_k \mu_k \frac{\partial h_j(\boldsymbol{x}|\alpha)}{\partial \alpha}
                                \end{align}
                            </p>


                            <!-- <ol>
                                <li>
                                    <p>最適性条件</p>
                                </li>
                                <li>コンテンツ</li>
                                <li>
                                    コンテンツ
                                    <ol class="bl_nestOrderList">
                                        <li>ネストコンテンツ</li>
                                        <li>ネストコンテンツ</li>
                                    </ol>
                                </li>
                                <li>
                                    コンテンツ
                                </li>
                            </ol> -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- <section class="ly_cont">
                <h2 class="el_lv2Heading">
                    参考文献
                </h2>
                <div class="bl_biblio">
                    <ol>
                        <li>
                            <a href="https://elischolar.library.yale.edu/cowles-discussion-paper-series/710">
                                McFadden, D.: Modelling the choice of residential location, In: Karlquist, A. et al.
                                (Eds.),
                                <br>
                                <span class="el_journal">Spatial Interaction Theory and Residential Location</span>
                                , North-Holland, Amsterdam, pp.75-96, 1978.
                            </a>
                        </li>
                    </ol>
                </div>
            </section> -->

        </article>

    </main>


    <footer>
        <div class="ly_footer">
            <div class="ly_footer_innner">
                <span class="el_copyRight">© Tsubasa Takeda</span>
            </div>
        </div>
    </footer>


</body>

</html>